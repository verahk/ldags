

rLDAG <- function(n, d, a) {
  seqn <- seq_len(n)

  dag <- as(pcalg::randDAG(n, d, weighted = F), "matrix")
  cpts <- L <- list()
  for (i in seqn) {
    pa <- seqn[dag[, i] == 1]
    npa <- length(pa)
    if (npa == 0) {
      p <- rbeta(1, a, a)
      cpts[[i]] <- array(c(p, 1-p), dim = 2)
    } else {
      nconf <- 2**npa
      S  <- sample(nconf, nconf, TRUE)
      uS <- unique(S)
      cpts
    }
  }


}

